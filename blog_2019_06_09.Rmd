---
pagetitle: "MMA, Ph.D., BlogPost: 09/06/2019"
---
<br />
```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r echo=FALSE, results='hide', message = FALSE}
packages <- c("reshape2", "tidyverse", "knitr", "janitor","multcomp",
              "gridExtra", "ggrepel", "ggpubr", "ggridges", "ggExtra", "ggiraphExtra","ggeffects",
              "psych", "lavaan", "semPlot",
              "factoextra", "FactoMineR", "cluster","mclust", "tidyLPA", "Gifi",
              "igraph",
              "stm", "quanteda","tidytext", "drlib", "tidystm",
              "future")
for(i in packages){
  if(!require(i, character.only = T)) install.packages(i, dependencies=T)
  library(i, character.only = T)
}
options(knitr.kable.NA = '') # for proper tables
plan(multiprocess) # to use multiple cores of the processor
load("TR.Rdata")
```

```{r echo=FALSE, results='hide', message = FALSE}
model <- 'cpat_fs + bpat_fs ~ CN_fs + Anx_fs + Avd_fs
CN_fs ~ Anx_fs + Avd_fs'
fit_TR <- sem(model, data=TR, estimator="mlr", mimic="mplus", missing="fiml", fixed.x = F)
```

# Juxtaposing psychometrics, topic modeling, and social network analysis to model competing nationalist discourses

Let’s entertain an idea… an elaborate idea… that is *people choose ideas, but ideas also choose people*. This is known as the ***elective affinities*** -- there is a “selective process by which ideas and their publics are bound together through forces of mutual attraction”. In other words, “there is a marketplace for things like ideologies, discourses, in which people are relatively free to choose ideologies and discourses that correspond to their own psychological needs” (Jost, 2017; Jost, Federico, & Napier, 2009).

The focus here is the discourses defined in the broadest sense: discourses

* are all the things that are said & written,
* reproduce through any sort of communication,
* provide packages of information that
    * structure cognition/perceptions
    * draw a comprehensive vision of the word.

**Nationalism as a discourse**: Nationalism is best understood as a particular form of discourse that constructs an image for the nation (Ozkirimli, 2017). Since nationalism operates as a discourse, it provides stories/narratives/packages of information on collective identity, as well as collective memory, and social representations of history. Nationalism tells us who we are, what/where we have been via spoken and/or written account of connected events (Hammack & Pilecki, 2012, 2014).

**Multiple nationalisms**: Since we are talking about nationalism as a discourse, we are looking at plural stories that contest and negotiate with one another. According to Ozkirimli (2017), multiple discourses compete for hegemony to no avail because … well … stories/ideas/collective representations do not disappear into thin air. Stories/ideas/collective representations merge… they become less salient… they come back in the right context… Therefore, there can never be a hegemony of one discourse.

**Nationalism and complex systems**: Surely, nationalism is at the core of many severe global problems and catastrophes. However, that does not change the fact that it has been involved in shaping human history in one form or another for centuries now, which suggests that it might provide some secondary-benefits in organizing complex social/collective units. Kaufmann (2017) argues that nationalism is an emergent phenomenon using the workings of complexity; he discusses *distributed knowledge* and suggests that social-units like nations can harness the dispersed local and temporal information-packages of this *distributed knowledge*.

The ideas on nationalism(s) operating as discourses and nationalism being an emergent phenomenon and benefiting from *distributed knowledge* are all complementary to the ***elective affinities***. So, the idea to entertain in this blog post is to model the ***elective affinities*** within the domain of nationalistic discourses. I do this by bringing together some techniques from psychometrics, structural topic modeling social network modeling.

The data here is a convenient Turkish sample from 2016. Participants responded to standardized scales; they also answered an open-ended question which asked them what it means to be Turkish to them. The following are the variables and their explanations. All values are normalized (ranging between 0-1) factor scores from CFA measurement models(, which are not shown here).

| Variable abbreviation | Construct               | Explanation                                                                            |
|-----------------------|-------------------------|----------------------------------------------------------------------------------------|
|Av_                    |Avoidant attachment style| higher scores indicate being aloof and emotionally distant in close relationships      |
|An_                    |Anxious attachment style | higher scores indicate being clingy, rejection-sensitive in close relationships and a tendency to adopt the role of a pursuer|
|CN_                    |Collective Narcissism    | higher scores indicate an exaggerated emotional investment in “an unrealistic psychologically-fragile belief in the nation’s greatness contingent on external validation” (Cichocka, 2016; Golec de Zavala, 2017)|
|bp_                    |Blind Patriotism         | higher scores indicate an uncritical allegiance to the country                         |
|cp_                    |Constructive Patriotism  | higher scores indicate a constructively critical allegiance to the country and a desire for positive change|

Below is the path model that shows structural relationships. The model is straightforward: attachment style predicts collective narcissism, which in turn predicts patriotisms. For a more elaborate model and explanation (including other variables) as well as a country comparison, take a look at [(Ardag, Cohrs, and Selck (2019)](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3321204).[^1]

```{r echo=FALSE, results='hide', fig.keep='all', message = FALSE}
semPaths(fit_TR, "mod", "std", intercepts = F, edge.label.cex=1, layout="tree3", rotation = 2)
```

The significant coefficients are displayed in the table below.

```{r echo=FALSE, message = FALSE}
parameterestimates(fit_TR, standardized = T) %>% 
  filter(op == "~") %>% 
  mutate(stars = ifelse(pvalue < .001, "***", 
                        ifelse(pvalue < .01, "**", 
                               ifelse(pvalue < .05, "*", "")))) %>%
 dplyr::select('Latent Factor'=lhs, 
         Predictor=rhs, 
         B=est, 
         SE=se, Z=z, 
         Beta=std.all, 
         sig=stars) %>% 
  kable(digits = 2, format="pandoc", caption="Regression coefficients")
```

I take out the avoidant attachment style (no significant association) and proceed with latent profile analysis using the four variables.

```{r echo=FALSE, results='hide', message = FALSE}
TR_mc <- Mclust(TR[,c("Anx_fs","CN_fs","cpat_fs","bpat_fs")])
summary(TR_mc)
TR$profile <- TR_mc$classification
TR_cp1=fviz_mclust(TR_mc, "BIC", palette = "jco", main = "TR Sample // Model Selection")
TR_cp2=fviz_mclust(TR_mc, "classification", geom = "point",
                   pointsize = 1, palette = "jco",
                   choose.vars = c("cpat_fs", "bpat_fs"),
                   main = "TR Sample",
                   xlab = "Constructive Patriotism", ylab = "Blind Patriotism")
TR_cp3=fviz_mclust(TR_mc, "uncertainty", palette = "jco", choose.vars = c("cpat_fs", "bpat_fs"),
                   main = "TR Sample",
                   xlab = "Constructive Patriotism", ylab = "Blind Patriotism")
TR_cp4=fviz_mclust(TR_mc, "classification", geom = "point",
                   pointsize = 1, palette = "jco",
                   choose.vars = c("Anx_fs", "CN_fs"),
                   main = "TR Sample",
                   xlab = "Anxious Att.Sty.", ylab = "Collective Narcissism")
TR_cp5=fviz_mclust(TR_mc, "uncertainty", palette = "jco", choose.vars = c("Anx_fs", "CN_fs"),
                   main = "TR Sample",
                   xlab = "Anxious Att.Sty.", ylab = "Collective Narcissism")
```

The results look like the following. There are four estimated profiles.

```{r echo=FALSE, results='hide', fig.keep='all', message = FALSE, fig.width=15, fig.height=8}
grid.arrange(TR_cp1,TR_cp2,TR_cp3,TR_cp4,TR_cp5,
             nrow=2, ncol=3)
TR %>% dplyr::select("Anx_fs","CN_fs","cpat_fs","bpat_fs") %>% estimate_profiles(4) %>% plot_profiles(alpha_range = 0.05, add_line = T)
```

Descriptive statistics are below. Profile 1 is low on blind patriotism; average on constructive patriotism; is spread across the range with collective narcissism and anxious style. Profile 2 is spread all over the range of blind patriotism & anxious attachment style; high on constructive patriotism & collective narcissism. Profile 3 is low on everything. Profile 4 is spread across blind & constructive patriotism ranges; has much overlap with Profile 2 on attachment style and collective narcissism traits.

|           | Anxious At.St. M(sD)| Collective Narciss. M(sD) | Constructive Pat. M(sD)| Blind Pat. M(sD)|
|-----------| --------------------|---------------------------|------------------------|-----------------|
|Profile 1  | 0.414 (0.26)        | 0.326 (0.15)              | 0.834 (0.13)           | 0.100 (0.04)    |
|Profile 2  | 0.401 (0.23)        | 0.759 (0.12)              | 0.973 (0.02)           | 0.351 (0.21)    |
|Profile 3  | 0.251 (0.19)        | 0.082 (0.09)              | 0.509 (0.30)           | 0.047 (0.02)    |
|Profile 4  | 0.454 (0.22)        | 0.663 (0.20)              | 0.777 (0.11)           | 0.484 (0.19)    |

```{r echo=FALSE, message = FALSE}
describe(TR[,c(4,7:9)])
```

In the next step, I use the profiles and some other covariates to estimate topics with structural topic modeling. Estimated topics should correspond to how these profiles perceive and frame their national identity. The results show that a four topics solution provide the most meaningful results, which is not surprising and new (again, refer to Ardag et al. 2018 for further details). I’m just finding/confirming what previous scholars were discussing about nationalistic discourses in Turkey (Bora, 2003, 2011; Özkırımlı, 2011).

```{r echo=FALSE, results='hide', message = FALSE}
TR_csw <- scan("tr_stop_words.txt",what = "character", sep = "\n")
TR_processed <- textProcessor(documents = TR$NItext,
                              metadata = TR,
                              language = "turkish",
                              onlycharacter = T,
                              stem = T,
                              removestopwords=F,
                              customstopwords = TR_csw)
TR_prep.docs.output <- prepDocuments(TR_processed$documents,
                                     TR_processed$vocab,
                                     TR_processed$meta,
                                     lower.thresh = 2)
TR_docs.ni <- TR_prep.docs.output$documents
TR_vocab.ni <- TR_prep.docs.output$vocab
TR_meta.ni <- TR_prep.docs.output$meta
TR_stm_ni <- stm(TR_docs.ni,
                 TR_vocab.ni,
                 K = 4,
                 prevalence =~ s(profile) + CN_fs + cpat_fs + bpat_fs,
                 data = TR_meta.ni, init.type = "LDA", seed = 2316877)
td_beta <- tidy(TR_stm_ni)
topic_summ <- td_beta %>%
  group_by(topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  mutate(topic = paste0("Topic ", topic),
         term = reorder_within(term, beta, topic)) %>%
  ggplot(aes(term, beta, fill = as.factor(topic))) +
  geom_col(alpha = 0.8, show.legend = FALSE) +
  facet_wrap(~ topic, scales = "free_y") +
  coord_flip() +
  scale_x_reordered() +
  labs(x = NULL, y = expression(beta),
       title = "Highest word probabilities for each topic",
       subtitle = "Different words are associated with different topics") + theme_bw()
td_gamma <- tidy(TR_stm_ni, matrix = "gamma",                    
                 document_names = rownames(TR_docs.ni))
td_gamma$profile <- NA
td_gamma$profile <- rep(TR_meta.ni$profile,4)
td_gamma$profile <- factor(td_gamma$profile, levels = c(1,2,3,4), labels = c("p1","p2","p3","p4"))
gamma_dist <- ggplot(td_gamma, aes(gamma, fill = profile)) +
  geom_histogram(alpha = 0.8, show.legend = FALSE) +
  facet_wrap(~ topic, ncol = 4) +
  labs(title = "Distribution of document probabilities for each topic...",
       subtitle = "... suggesting topics are associated with many observations",
       caption = "histogram colors correspond to profiles in the gamma plots",
       y = "# of observations", x = expression(gamma)) + theme_bw()
```

Below are some highlights from the topic estimation.

```{r echo=FALSE, results='hide', fig.keep='all', message = FALSE, fig.width=15, fig.height=8}
grid.arrange(topic_summ, gamma_dist, nrow=2, ncol=1)
```

```{r echo=FALSE, results='hide', message = FALSE}
theta <- TR_stm_ni$theta
thetas <- data.frame(topic1 = theta[,1],
                     topic2 = theta[,2],
                     topic3 = theta[,3],
                     topic4 = theta[,4])
meta_full <- cbind(TR_meta.ni, thetas)
meta_full$profile <- factor(meta_full$profile, levels = c(1,2,3,4), labels = c("p1","p2","p3","p4"))
nw_data <- meta_full %>% dplyr::select(c(1,11:15))
nw_data [,c(3:6)] <- round(nw_data [,c(3:6)],2)
nw_data$profile_n <- as.numeric(nw_data$profile)
aov_topic1 <- aov(topic1 ~ profile, data = nw_data)
aov_topic2 <- aov(topic2 ~ profile, data = nw_data)
aov_topic3 <- aov(topic3 ~ profile, data = nw_data)
aov_topic4 <- aov(topic4 ~ profile, data = nw_data)
topic1_bp <- ggboxplot(nw_data, x = "profile", y = "topic1", 
                       color = "profile", palette = "jco",
                       order = c("p1", "p2", "p3", "p4"),
                       ylab = "Topic 1", xlab = "Profile")
topic2_bp <- ggboxplot(nw_data, x = "profile", y = "topic2", 
                       color = "profile", palette = "jco",
                       order = c("p1", "p2", "p3", "p4"),
                       ylab = "Topic 2", xlab = "Profile")
topic3_bp <- ggboxplot(nw_data, x = "profile", y = "topic3", 
                       color = "profile", palette = "jco",
                       order = c("p1", "p2", "p3", "p4"),
                       ylab = "Topic 3", xlab = "Profile")
topic4_bp <- ggboxplot(nw_data, x = "profile", y = "topic4", 
                       color = "profile", palette = "jco",
                       order = c("p1", "p2", "p3", "p4"),
                       ylab = "Topic 4", xlab = "Profile")
topic1_rdp <- ggplot(nw_data, aes(x=topic1, y=profile, fill=factor(..quantile..))) +
  stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = T, quantiles = c(0.025, 0.975)) +
  scale_fill_manual(name = "Probability", values = c("#FF0000A0", "#A0A0A0A0", "#0000FFA0"),
    labels = c("(0, 0.025]", "(0.025, 0.975]", "(0.975, 1]")) + ggtitle("Topic 1 Ridge Density Plot") + theme_bw()
topic2_rdp <- ggplot(nw_data, aes(x=topic2, y=profile, fill=factor(..quantile..))) +
  stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = T, quantiles = c(0.025, 0.975)) +
  scale_fill_manual(name = "Probability", values = c("#FF0000A0", "#A0A0A0A0", "#0000FFA0"),
                    labels = c("(0, 0.025]", "(0.025, 0.975]", "(0.975, 1]")) + ggtitle("Topic 2 Ridge Density Plot") + theme_bw()
topic3_rdp <- ggplot(nw_data, aes(x=topic3, y=profile, fill=factor(..quantile..))) +
  stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = T, quantiles = c(0.025, 0.975)) +
  scale_fill_manual(name = "Probability", values = c("#FF0000A0", "#A0A0A0A0", "#0000FFA0"),
                    labels = c("(0, 0.025]", "(0.025, 0.975]", "(0.975, 1]")) + ggtitle("Topic 3 Ridge Density Plot") + theme_bw()
topic4_rdp <- ggplot(nw_data, aes(x=topic4, y=profile, fill=factor(..quantile..))) +
  stat_density_ridges(geom = "density_ridges_gradient", calc_ecdf = T, quantiles = c(0.025, 0.975)) +
  scale_fill_manual(name = "Probability", values = c("#FF0000A0", "#A0A0A0A0", "#0000FFA0"),
                    labels = c("(0, 0.025]", "(0.025, 0.975]", "(0.975, 1]")) + ggtitle("Topic 4 Ridge Density Plot") + theme_bw()
```

The first topic frames Turkishness by referencing citizenship, geography, shared culture, and feeling (one interpretation of the founding ideology of Kemalism). The parts of the open responses that fall into the second topic make references to ethnicity. The third topic captures frames that make references to both ethnicity and religion. The framing in the fourth topic is close to topic 1; but there is much additional reference to the founding father of Turkey, Atatürk, and the tone and interpretation of Kemalism are different for this topic.

***Elective affinities -- people choosing ideas***: The benefit of stm here is its mixed-group membership model. Since all open ended responses include words associated with all different estimated topics, we can extract relevant information on the estimated topics, and their covariates. Below is some selected relevant information on *people choosing ideas*.

```{r echo=FALSE, results='hide', fig.keep='all', message = FALSE, fig.width=15, fig.height=8}
grid.arrange(topic1_bp,topic2_bp,topic1_rdp,topic2_rdp,
             topic3_bp,topic4_bp,topic3_rdp,topic4_rdp,
             nrow=2,ncol=4)
```

In a nutshell, for topic 1, there are significant differences between p2 - p1, p4 - p2 and p4 - p3. Nothing is going on for topic 2. For topic 3, the significant differences are between p3 - p1, p3 - p2, and p4 - p3. Almost all profiles are significantly different from one another on topic 4… the only exception is p4 - p1 (, which still has p < 0.07). The boxplots and the ridged density plots are above.

***Elective affinities -- ideas choosing people***: Social network modeling can give us insights here. I treat the topic proportions as an incidence matrix and plot a bipartite network of discourses connecting people. The centrality measures should provide us with an idea about the influence of different discourses. Here is how *ideas choosing people* part of ***elective affinities*** looks like.

```{r echo=FALSE, results='hide', message = FALSE}
g <- graph.incidence(nw_data[3:6], weighted = T)
V(g)$shape <- ifelse(V(g)$type, "square", "circle")
V(g)$color[!V(g)$type] <- nw_data$profile_n
V(g)$name[!V(g)$type] <- as.character(nw_data$profile)
V(g)$size <- 7
V(g)$label.cex=.6
V(g)$color[V(g)$type] <- "red"
E(g)$color <- "lightgray"
```

Below is the network. Circle nodes are the participants of the survey; node color corresponds to the estimated latent profile. Red squares are the topics. The edge weights connecting the topics and participants are the topic proportions.

```{r echo=FALSE, results='hide', fig.keep='all', message = FALSE, fig.width=15, fig.height=8}
par(mar = c(1,1,1,1))
plot(g, edge.width=E(g)$weight*10, main="Bipartite Discourse Network: Discources Connecting People (Profiles)")
```

|       |Eigen vector centrality|Closeness|Betweenness|
|-------|-----------------------|---------|-----------|
|Topic 1|0.70                   | 4.28    |0.834      | 
|Topic 2|0.73                   | 4.15    |0.973      |
|Topic 3|0.64                   | 4.54    |0.509      | 
|Topic 4|1.00                   | 3.21    |0.777      |


The most influential discourse is topic 1 (with eigenvector centrality value = 1) – the official founding ideology of Turkey (Kemalism) with its interpretation that (over-)praises Mustafa Kemal Atatürk. This is no surprise given that I have a biased convenience sample. Majority of the participants in the sample are urban, young, university students who self-reported to be secular and non-AKP supporters. It’s expected that they frame most of their Turkishness definition with the vocabulary of the Kemalist discourse. The second influential discourse is the one that makes references to Turkishness as an ethnic category (topic 2). Again, no surprises; ethnicity has always been a salient issue in Turkey, which has been instrumentalized in various ways to exclude non-Muslims and Kurds. This discourse has always had its ultra-nationalist/racist version and Kemalist version. The current governing party AKP has been transforming a mixture of the two to create its own hybrid. The third influencial discourse is topic 1: a more civic and cosmopolitan interpretation of Kemalism that emerged in the late 1980s; that is followed by the discourse that interbreeds ethnicity and religion (topic 3).

Closeness and betweenness centrality measures can also provide fruitful information about the influence of discourses; however, in this case, I think it will be susceptible to over-stretched interpretations.

**What is the point**: People internalize multiple discourses and possess the ideas that come with these discourses. The ideas might be in conflict and/or competition; ideas might be contradictory. People might be selective in the degree they internalize these different ideas; ideas permeate their hosts, nevertheless. Nationalist discourses might look like a messy patchwork of stories or like bad semantic salad. However, if you zoom out, you see that it functions for at least for two things.

* It provides some sort of organization (I’m not saying good organization) for large social & political units like nation-states.
* It functions for itself.

If nationalism is really a thing with emergent properties, exploiting *distributed knowledge* and all that stuff, then perhaps there is reason to think that it also functions for itself. It creates multiple versions of itself -- variation is always necessary for survival, then uses peoples/profiles as "vehichles" (Dawkins, 1976) for reproduction, spread, and recombination... We should not be surprised to observe multiple nationalistic discourses, incoherent, and conflicting narratives in any given nation/population... or across populations.

Of course, these results I present here have quite a few limitations. I already mentioned the sample bias. STM requires big text data – much larger corpus than the one I have here. Nevertheless, I think the whole modeling process is pretty useful if you want to entertain the idea of ***elective affinities***. I think one can do a lot with bigger and more representative data for a population.

## References

Ardag, M. M., Cohrs, J. C., & Selck, T. J. (2019). A Multi-Method Approach to National Identity: From Individual Level Attachment to National Attachment. SSRN. doi:http://dx.doi.org/10.2139/ssrn.3321204
</br>Bora, T. (2003). Nationalist Discourses in Turkey. The South Atlantic Quarterly, 102(2-3), 433-451. 
</br>Bora, T. (2011). Nationalist Discourses in Turkey. In A. Kadioglu & E. F. Keyman (Eds.), Symbiotic antagonisms : competing nationalisms in Turkey (pp. 57-81). Salt Lake City: University of Utah Press.
</br>Cichocka, A. (2016). Understanding defensive and secure in-group positivity: The role of collective narcissism. European Review of Social Psychology, 27(1), 283-317. doi:10.1080/10463283.2016.1252530
</br>Dawkins, R. (1976). The selfish gene. Oxford: Oxford University Press.
</br>Golec de Zavala, A. (2017). Collective narcissism: antecedents and consequences of exaggeration of the in-group image. In A. Hermann, A. Brunell, & J. Foster (Eds.), The Handbook of Trait Narcissism: Key Advances, Research Methods, and Controversies: Springer.
</br>Hammack, P. L., & Pilecki, A. (2012). Narrative as a Root Metaphor for Political Psychology. Political Psychology, 33(1), 75-103. 
</br>Hammack, P. L., & Pilecki, A. (2014). Methodological Approaches in Political Psychology: Discourse and Narrative. In P. Nesbitt-Larking, C. Kinnvall, & T. Capelos (Eds.), The Palgrave Handbook of Global Political Psychology (pp. 72-89). Hampshire: Palgrave Macmillan UK.
</br>Jost, J. T. (2017). The marketplace of ideology: “Elective affinities” in political psychology and their implications for consumer behavior. Journal of Consumer Psychology, 27(4), 502-520. doi:https://doi.org/10.1016/j.jcps.2017.07.003
</br>Jost, J. T., Federico, C. M., & Napier, J. L. (2009). Political ideology: Its structure, functions, and elective affinities. Annual review of psychology, 60, 307-337. 
</br>Kaufmann, E. (2017). Complexity and nationalism. Nations and Nationalism, 23(1), 6-25. doi:10.1111/nana.12270
</br>Ozkirimli, U. (2017). Theories of Nationalism: A Critical Introduction: Macmillan Education UK.
</br>Özkırımlı, U. (2011). The Changing Nature of Nationalism in Turkey Actors, Discourses, and the Struggle for Hegemony. In A. Kadioglu & E. F. Keyman (Eds.), Symbiotic antagonisms : competing nationalisms in Turkey (pp. 82-100). Salt Lake City: University of Utah Press.

[^1]: <font size="1">Attachment style is there because it is something deeply embedded within the individuals with genetic & environmental influences. These discourses have to impact something within the individual to be appealing to them. I think discourses hijack the psychological market place via acting upon attachment style – my study provides some empirical evidence for that.</font>