---
pagetitle: "MMA, Ph.D., BlogPost: 26/04/2019"
---
<br />
```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=15, fig.height=10,
                      echo=F, warning=F, message=F)
```

```{r echo=FALSE, results='hide', message = FALSE}
load("DE.RData")
```

# An informal benchmarking within psychometrics: attitude network approach vs. the general SEM framework using German national identity as an example

Many scholars misleadingly equate psychometrics to IRT today. However, IRT cannot be the solo rock star of psychometrics. Quoting [this guy](http://www.iops.nl/wp-content/uploads/2015/02/ThePhilosophyOfPsychometrics_2015_DennyBorsboom.pdf){target="_blank"} psychometrics has got something to do with formalizing the connection between data and theory; realizing that has multiple paths. So let's traverse some of those paths, shall we?..

The workhorse of psychometrics has been the general SEM framework, particularly the latent variable models built with CFAs, and more recently with the IRTs. There is a cool new kid on the block now, though... actually has been there for a while now. This kid may be more similar to the existing workhorse in many ways. Yes! I'm talking about latent variable models and network models being equivalent again. [Here](https://doi.org/10.1080/00273171.2019.1672515){target="_blank"} is a more recent paper. Basically, we are one more step ahead when it comes to understanding and distinguishing the equivalence in unidimensional constructs; however, we need more time and research for scrutinizing the equivalence in multi-dimensional constructs. But I'm simply impatient.

In this blog post, I want to do 3 things.

* See the correspondence between IRT's item information curves and node centrality in attitude networks. Node centrality in attitude networks has been one of the weakest links in this paradigm. See [this](https://psycnet.apa.org/doi/10.1037/abn0000446){target="_blank"}[^1]
* Compare two R packages on the item-reduction task within the psychological networks approach
    * See if these item-reduction techniques from the packages can somewhat improve possible node centrality interpretations
* Try to learn a few things about German national identity with a convenient sample by seeing
    * how it can be measured best with attitude networks
    * what the correlates of national identification might be in Germany
    * the role of subjectivity -- that is, investigating the psychological profiles of different national identifiers.

I am using two instruments measuring very closely related psychological constructs: [*collective narcissism*](https://doi.org/10.1111/pops.12569){target="_blank"}[^2]  and [*national identification*](https://econtent.hogrefe.com/doi/10.1027/1864-9335/a000243){target="_blank"}. Let's start with the SEM framework. Item wordings and latent constructs are displayed in the table below.


<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-9wq8{border-color:inherit;text-align:center;vertical-align:middle}
.tg .tg-4erg{font-weight:bold;font-style:italic;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-4erg">2nd Order latent construct</th>
    <th class="tg-4erg">1st Order latent construct</th>
    <th class="tg-4erg">variable name</th>
    <th class="tg-4erg">Item Abbreviation<br></th>
    <th class="tg-4erg">Item wording</th>
  </tr>
  <tr>
    <td class="tg-9wq8" rowspan="9">Self-Investment (SIn)</td>
    <td class="tg-9wq8" rowspan="3">Centrality (Ce)</td>
    <td class="tg-0pky">nice01</td>
    <td class="tg-0pky">Ce1</td>
    <td class="tg-0pky">I often think about the fact that I am German.</td>
  </tr>
  <tr>
    <td class="tg-0pky">nice02</td>
    <td class="tg-0pky">Ce2</td>
    <td class="tg-0pky">The fact that I am German is an important part of my identity.</td>
  </tr>
  <tr>
    <td class="tg-0pky">nice03</td>
    <td class="tg-0pky">Ce3</td>
    <td class="tg-0pky">Being German is an important part of how I see myself.</td>
  </tr>
  <tr>
    <td class="tg-9wq8" rowspan="3">Solidarity (So)</td>
    <td class="tg-0pky">niso01</td>
    <td class="tg-0pky">So1</td>
    <td class="tg-0pky">I feel a bond with Germans.</td>
  </tr>
  <tr>
    <td class="tg-0pky">niso02</td>
    <td class="tg-0pky">So2</td>
    <td class="tg-0pky">I feel solidarity with Germans.</td>
  </tr>
  <tr>
    <td class="tg-0pky">niso03</td>
    <td class="tg-0pky">So3</td>
    <td class="tg-0pky">I feel committed to Germans.</td>
  </tr>
  <tr>
    <td class="tg-9wq8" rowspan="3">Satisfaction (Sa)</td>
    <td class="tg-0pky">nisa01</td>
    <td class="tg-0pky">Sa1</td>
    <td class="tg-0pky">I am glad to be German.</td>
  </tr>
  <tr>
    <td class="tg-0pky">nisa02</td>
    <td class="tg-0pky">Sa2</td>
    <td class="tg-0pky">It is pleasant to be German.</td>
  </tr>
  <tr>
    <td class="tg-0pky">nisa03</td>
    <td class="tg-0pky">Sa3</td>
    <td class="tg-0pky">Being German gives me a good feeling.</td>
  </tr>
  <tr>
    <td class="tg-9wq8" rowspan="6">Self-Definition (SDe)</td>
    <td class="tg-9wq8" rowspan="3">Self-Stereotyping (Ss)</td>
    <td class="tg-0pky">niss01</td>
    <td class="tg-0pky">Ss1</td>
    <td class="tg-0pky">I have a lot in common with the average German person.</td>
  </tr>
  <tr>
    <td class="tg-0pky">niss02</td>
    <td class="tg-0pky">Ss2</td>
    <td class="tg-0pky">I am similar to the average German person.</td>
  </tr>
  <tr>
    <td class="tg-0pky">niss03</td>
    <td class="tg-0pky">Ss3</td>
    <td class="tg-0pky">I am a typical German.</td>
  </tr>
  <tr>
    <td class="tg-9wq8" rowspan="3">In-Group Homogeneity (IH)</td>
    <td class="tg-0pky">niho01</td>
    <td class="tg-0pky">Ih1</td>
    <td class="tg-0pky">German people have a lot in common with each other.</td>
  </tr>
  <tr>
    <td class="tg-0pky">niho02</td>
    <td class="tg-0pky">Ih2</td>
    <td class="tg-0pky">German people are very similar to each other.</td>
  </tr>
  <tr>
    <td class="tg-0pky">niho03</td>
    <td class="tg-0pky">Ih3</td>
    <td class="tg-0pky">German share a lot of the same characteristics.</td>
  </tr>
  <tr>
    <td class="tg-0pky" rowspan="5"></td>
    <td class="tg-9wq8" rowspan="5">Collective Narcissism (CN)</td>
    <td class="tg-0pky">cn2</td>
    <td class="tg-0pky">Cn2</td>
    <td class="tg-0pky">Germany deserves special treatment.</td>
  </tr>
  <tr>
    <td class="tg-0pky">cn3</td>
    <td class="tg-0pky">Cn3</td>
    <td class="tg-0pky">I will never be satisfied until Germany gets all it deserves.</td>
  </tr>
  <tr>
    <td class="tg-0pky">cn5</td>
    <td class="tg-0pky">Cn5</td>
    <td class="tg-0pky">It really makes me angry when others criticize Germany.</td>
  </tr>
  <tr>
    <td class="tg-0pky">cn6</td>
    <td class="tg-0pky">Cn6</td>
    <td class="tg-0pky">If other countries listened to Germany more, the world would be a much better place.</td>
  </tr>
  <tr>
    <td class="tg-0pky">cn8</td>
    <td class="tg-0pky">Cn8</td>
    <td class="tg-0pky">Not many people seem to fully understand the importance of Germany.</td>
  </tr>
</table>

## The SEM framework: CFA & IRT

```{r echo=FALSE, results='hide', message = FALSE}
library(lavaan)
ni_CFA <- '
CN =~ cn2 + cn3 + cn5 + cn6 + cn8
Ce =~ nice01 +  nice02 + nice03
So =~ niso01 + niso02 + niso03
Sa =~ nisa01 + nisa02 + nisa03
Ss =~ niss01 + niss02 + niss03
IH =~ niho01 +  niho02 + niho03
SIn =~ Ce + So + Sa
SDe =~ Ss + IH
'
ni_CFA_fit <- cfa(ni_CFA, DE, estimator = "mlr", estimator="mlr", std.ov=T, std.lv=T, mimic="mplus", missing="fiml")
summary(ni_CFA_fit, fit.measures=T, standardized=T, rsquare=T)
library(semPlot)
#library(semTools)
#round(reliability(ni_CFA_fit),2);round(reliabilityL2(ni_CFA_fit,"SIn"),2);round(reliabilityL2(ni_CFA_fit,"SDe"),2)
```

The overall measurement model looks like the following. 

```{r echo=FALSE, results='hide', message = FALSE}
semPaths(ni_CFA_fit, "mod", "std", intercepts = F, edge.label.cex=.7,
         layout="tree", sizeMan = 2, sizeLat = 5, sizeLat2 = 3,
          optimizeLatRes = T, mar = c(1.5,1.5,1.5,1.5))
title(sub="National Identity CFA")
```


Here is the goodness of fit stats and reliabilities.
</br>

|                                                           |                           |                         |                                |
|-----------------------------------------------------------|--------------------------:|------------------------:|-------------------------------:|
| Robust $\chi^2$ (df):                                     |          907.029 (162)*** |                         |                                |
| Scaling correction factor for the Yuan-Bentler correction |                     1.165 |                         |                                |
| Robust CFI:                                               |                     0.967 |                         |                                |
| Robust TLI:                                               |                     0.962 |                         |                                |
| Robust RMSEA (P-value) 90 % CI:                           | 0.049 (0.994) 0.046-0.053 |                         |                                |
| SRMR:                                                     |                     0.037 |                         |                                |
| $\omega_{total}$                                          |                      0.96 |                         |                                |
| $\omega_{CN}$                                             |                      0.84 |                         |                                |
| $\omega_{Ce}$                                             |                      0.82 |                         |                                |
| $\omega_{So}$                                             |                      0.85 |                         |                                |
| $\omega_{Sa}$                                             |                      0.86 |                         |                                |
| $\omega_{Ss}$                                             |                      0.89 |                         |                                |
| $\omega_{IH}$                                             |                      0.86 |                         |                                |
| $\omega_{SIn}$                                            |                      0.94 | $\omega_{level1}$: 0.87 | partial $\omega_{level1}$:0.93 |
| $\omega_{SDef}$                                           |                      0.73 |  $\omega_{level1}$:0.65 | partial $\omega_{level1}$:0.88 |


</br>
All GoF stats look pretty good. Let's switch from the reliability stuff to a different paradigm. Item information curves (IIC) and cumulated information with measurement error (TCC + error) are displayed in the plots below for each construct[^3].

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
library(mirt)
## Collective narcissism
CN_IRT <- mirt(DE[,c("cn2","cn3","cn5","cn6","cn8")],
               model = 1,
               itemtype = "graded",
               technical=list(removeEmptyRows=T))
CN_iif <- plot(CN_IRT, type = "infotrace", main = "Col.Nar.")
CN_iise <- plot(CN_IRT, type = "infoSE", main = "")
## Centrality
Ce_IRT <- mirt(DE[,c("nice01","nice02","nice03")],
               model = 1,
               itemtype = "graded",
               technical=list(removeEmptyRows=T))
Ce_iif <- plot(Ce_IRT, type = "infotrace", main = "Cent.")
Ce_iise <- plot(Ce_IRT, type = "infoSE", main = "")
## Solidarity
So_IRT <- mirt(DE[,c("niso01","niso02","niso03")],
               model = 1,
               itemtype = "graded",
               technical=list(removeEmptyRows=T))
So_iif <- plot(So_IRT, type = "infotrace", main = "Soli.")
So_iise <- plot(So_IRT, type = "infoSE", main = "")
## Satisfaction
Sa_IRT <- mirt(DE[,c("nisa01","nisa02","nisa03")],
               model = 1,
               itemtype = "graded",
               technical=list(removeEmptyRows=T))
Sa_iif <- plot(Sa_IRT, type = "infotrace", main = "Sati.")
Sa_iise <- plot(Sa_IRT, type = "infoSE", main = "")
## Self-stereotyping
Ss_IRT <- mirt(DE[,c("niss01","niss02","niss03")],
               model = 1,
               itemtype = "graded",
               technical=list(removeEmptyRows=T))
Ss_iif <- plot(Ss_IRT, type = "infotrace", main = "Self-Ste.")
Ss_iise <- plot(Ss_IRT, type = "infoSE", main = "")
## In-group homogeneity
Ho_IRT <- mirt(DE[,c("niho01","niho02","niho03")],
               model = 1,
               itemtype = "graded",
               technical=list(removeEmptyRows=T))
Ho_iif <- plot(Ho_IRT, type = "infotrace", main = "In-Grp.Ho.")
Ho_iise <- plot(Ho_IRT, type = "infoSE", main = "")
library(gridExtra)
grid.arrange(CN_iif,Ce_iif,So_iif,Sa_iif,Ss_iif,Ho_iif,
             CN_iise,Ce_iise,So_iise,Sa_iise,Ss_iise,Ho_iise,
             ncol = 6, nrow=2,
             top = "IRT GRM",
             bottom = "Top row = item information curves
                       \nBottom row = cumulated information + error")
rm(list=setdiff(ls(), "DE"))
```

*Collective narcissism* and *self-stereotyping* have more accumulated information compared to the other constructs. Though, with *collective narcissism*, the low error range on the latent continuum is a bit narrower compared to the other constructs. I especially like the error line of *solidarity*, *satisfaction*, and *self-stereotyping* scales. All these observations are not super relevant to what I intend to do below. Let’s just keep an eye on the IICs. Cn3, nice03, niso01, nisa02, niss02, and niho03 have the peaking info curves.

## Switching to the attitude networks paradigm

Quick recap: the network represents the true relationship across the items; edges are the penalized associations, red being negative, blue being positive. The color of the nodes can/might/should correspond to the underlying latent constructs. Louvain community detection algorithm lumps centrality and solidarity items together. The rest is the same as the measurement model. What I like about the plot on the right (the network plot with MDS configuration layout (see [here](https://doi.org/10.3389/fpsyg.2018.01742){target="_blank"}) is the scale items coming properly together.

##### Attitude network with all items

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
lbs <- scan("DE.RData_00_labels.txt",what = "character", sep = "\n")
library(bootnet)
nw <- estimateNetwork(DE[,c(12:31)], default = "EBICglasso", tuning = 0.5, missing = "pairwise", threshold = T, lambda.min.ratio=0.001)
library(qgraph)
nw_wmat <- getWmat(nw)
library(igraph)
nw_gam <- graph_from_adjacency_matrix(abs(nw_wmat), "undirected", weighted = T, add.colnames = F)
nw_comm_lo <- cluster_louvain(nw_gam)
library(networktools)
par(mfrow=c(1,2))
plot(nw, layout = "spring", maximum=1, edge.labels=T, edge.label.cex=1,
     details = T, title = "Force-directed
                           \nLouvain community detection", vTrans = 200,
     labels = lbs, groups = communities(nw_comm_lo), legend=F)
MDSnet(nw$graph, maximum=1, edge.labels=T, edge.label.cex=1, theme = "colorblind",
       title = "MDS Configuration
                \nLouvain community detection", vTrans = 200,
       labels = lbs, groups = communities(nw_comm_lo), legend=F)
dev.off()
```

I am not even going to interpret the centrality plot below at this early stage, but we are already seeing the hint that the two-step expected influence makes a difference in an attitude network of multiple latent constructs’ items.

##### Centrality plot of the network with all items

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='none'}
nw_cp <- centralityPlot(nw, scale = "z-scores", include = c("ExpectedInfluence"), orderBy = "ExpectedInfluence", labels = lbs)
nw_cp_nw_op <- expectedInf(nw$graph)
nw_cp_nw <- plot(nw_cp_nw_op, order="value", zscore=T)
```

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
grid.arrange(nw_cp,nw_cp_nw,
             ncol = 2, nrow=1,
             left = "by qgraph",
             right = "by networktools")
```

One can use two R libraries (namely ```networktools``` and ```EGAnet```) for item reduction in an attitude network. We may need item reduction in an attitude network simply because inflated and misleading associations might remain in the network even after regularization. Both packages offer unique empirical ways to eliminate inflated associations. While networktools suggests and removes redundant items with two convenient functions, EGAnet enables manual intervention. Below are the problematic item-pairs suggested by networktools.

### Item reduction with networktools: automatic empirical suggestion

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
#### try net_reduce
#gb_items <- goldbricker(DE[,c(12:31)], p = 0.01, threshold=0.5, corMin = 0.5)
#net_reduce(DE[,c(12:31)], badpairs = gb_items, method = "best_goldbricker")
```

| suggested reductions |   | proportion values of the bad pairs |
|----------------------|:-:|-----------------------------------:|
| cn8 & cn2            |   |                          0.1111111 |
| niso03 & nice03      |   |                          0.2222222 |
| nisa02 & nisa01      |   |                          0.2222222 |
| niss03 & niss01      |   |                          0.2777778 |
| niss03 & niss02      |   |                          0.2777778 |
| niso02 & nice02      |   |                          0.3333333 |
| nisa03 & niso03      |   |                          0.3333333 |
| niso01 & nice02      |   |                          0.3888889 |
| niso03 & nice02      |   |                          0.3888889 |
| nisa03 & nice02      |   |                          0.3888889 |
| niso02 & niso01      |   |                          0.3888889 |
| nisa03 & niso01      |   |                          0.3888889 |
| niso02 & nice03      |   |                          0.4444444 |
| nisa03 & niso02      |   |                          0.4444444 |

The good thing about the networktools’ convenient functions is the automatic suggestion and removal. Though, in my experience, when you have attitude networks composed of multiple latent constructs’ items, networktools’ convenient functions become a bit inconvenient as we see above. In this particular example, the automatic removal does not also work simply because quite a few items belong to multiple “bad-pairs”. The small table below shows all the problematic items ordered by scale. I am going to go ahead and brutally kill all these bad boys.

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-c3ow{border-color:inherit;text-align:center;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-c3ow" colspan="5">Items suggested for reduction</th>
  </tr>
  <tr>
    <td class="tg-c3ow">nice02</td>
    <td class="tg-c3ow">niso01</td>
    <td class="tg-c3ow">nisa01</td>
    <td class="tg-c3ow">niss01</td>
    <td class="tg-c3ow">cn2</td>
  </tr>
  <tr>
    <td class="tg-c3ow">nice03</td>
    <td class="tg-c3ow">niso02</td>
    <td class="tg-c3ow">nisa02</td>
    <td class="tg-c3ow">niss02</td>
    <td class="tg-c3ow">cn8</td>
  </tr>
  <tr>
    <td class="tg-c3ow"></td>
    <td class="tg-c3ow">niso03</td>
    <td class="tg-c3ow">nisa03</td>
    <td class="tg-c3ow">niss03</td>
    <td class="tg-c3ow"></td>
  </tr>
</table>

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
library(tidyverse)
new_nw_data <- DE %>% select(12:31) %>% select(-c(nice02, nice03,
                                                  niso01,niso02,niso03,
                                                  nisa01,nisa02,nisa03,
                                                  niss01,niss02,niss03,
                                                  cn2,cn8))
```
</br>
Below is the resulting new attitude network with reduced items. *In-group homogeneity* is still its own thing; one *centrality* item joined *collective narcissism*.

##### Attitude network with reduced items: ```networktools```

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
lbs_up <- scan("DE.RData_00_labels_up.txt",what = "character", sep = "\n")
nw_red <- estimateNetwork(new_nw_data, default = "EBICglasso", tuning = 0.5, missing = "pairwise", threshold = T, lambda.min.ratio=0.001)
nw_red_wmat <- getWmat(nw_red)
nw_red_gam <- graph_from_adjacency_matrix(abs(nw_red_wmat), "undirected", weighted = T, add.colnames = F)
nw_red_comm_lo <- cluster_louvain(nw_red_gam)
par(mfrow=c(1,2))
plot(nw_red, layout = "spring", maximum=1, edge.labels=T, edge.label.cex=1,
     details = T, title = "Network after net_reduce item reduction
                           \nForce-directed
                           \nLouvain community detection", vTrans = 200,
     labels = lbs_up, groups = communities(nw_red_comm_lo), legend=F)
MDSnet(nw_red$graph, maximum=1, edge.labels=T, edge.label.cex=1, theme = "colorblind",
       title = "Network after net_reduce item reduction
                \nMDS Configuration
                \nLouvain community detection", vTrans = 200,
       labels = lbs_up, groups = communities(nw_red_comm_lo), legend=F)
dev.off()
```

Note that the item reduction strategy by networktools works on two adjacent vertices/nodes, and apparently, it does not automatically account for cliques.

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='none'}
net_red_cp <- centralityPlot(nw_red, scale = "z-scores", include = c("ExpectedInfluence"),
                             orderBy = "ExpectedInfluence", labels = lbs_up)
nw_red_cp_nw_op <- expectedInf(nw_red$graph)
nw_red_cp_nw <- plot(nw_red_cp_nw_op, order="value", zscore=T)
```

And here is the centrality plot of the network with reduced items. It is still better to rely on the two-step expected influence. We got niho03, cn3, and niho02 at the top in contrast to nisa03, nice02, and niss02 (all absent/dead in this reduced network). cn3 and niho03 are the items with the highest information in their respective scales. Still, we lost other potential informative items like nice03, niss02, which I brutally killed after the bad-pair suggestions by networktools. 

##### centrality plot of the network after item reduction with ```networktools```

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
grid.arrange(net_red_cp,nw_red_cp_nw,
             ncol = 2, nrow=1,
             left = "by qgraph",
             right = "by networktools")
rm(list=setdiff(ls(), "DE"))
```

### Item reduction with EGAnet: manual empirical suggestion 

```{r echo=FALSE, results='hide', message = FALSE}
#DE_RData_00_01_items_dic <- readxl::read_excel("DE.RData_00_01_items_dic.xlsx")
library(EGAnet)
#DE_miss <- DE %>% drop_na() # down to 1567 from 2223
#rio::export(DE_miss, file = "DE_miss.xlsx")
#key.ind <- match(colnames(DE_miss[,12:31]), DE_RData_00_01_items_dic$item_id)
#key <- DE_RData_00_01_items_dic$item[key.ind]
```

```{r echo=FALSE, results='hide', message = FALSE}
# Identify redundant nodes
#redund <- node.redundant(DE_miss[,12:31], method = "wTO", type = "adapt")
# Use key to rename variables
#named.nr <- node.redundant.names(redund, key)
# Combining redundant responses
#combined.nr <- node.redundant.combine(named.nr, type = "latent")
# New items
#new.items <- combined.nr$data
#class(new.items)
# Write merged items
#write.csv(combined.nr$merged, "merged.items.csv")
#rio::export(new.items, file = "new_items_from_EGA_reduced.xlsx")
new.items <- readxl::read_excel("new_items_from_EGA_reduced.xlsx")
```

EGAnet (in contrast to networktools) provides more control and forces you to think while you are manually making your choices. It plays on the cliques in the network by offering you a target node (see the vignette-like tutorial [here](https://psyarxiv.com/ktejp/){target="_blank"}). The coolest thing is that the whole procedure is designed for the networks that include multiple latent constructs. In this example, I only removed the adjacent two nodes within cliques and ended up with the following network. The plot displays the reduced attitude network after the Louvain community detection algorithm.

##### Attitude network with reduced items: ```EGAnet```

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
# Examine dimensions
ega <- EGA(new.items, model = "glasso", algorithm = "louvain", plot.EGA = F)
plot(ega, maximum=1, edge.labels=T, edge.label.cex=1, vTrans = 200)
# Compute standardized node strength
#net.loads(ega)$std
```

We can also get the network loadings. We are looking at *centrality*, *solidarity*, and *collective narcissism* remaining “as is” in the network. *Solidarity* is within a community that includes combined “in-group homogeneity” and satisfaction scales.

##### Network loadings

|                                                |   |     1 |     2 |     3 |
|------------------------------------------------|:-:|------:|------:|------:|
| Cen01                                          |   | 0.206 | 0.070 | 0.059 |
| Cen02                                          |   | 0.270 | 0.241 | 0.031 |
| Cen03                                          |   | 0.346 | 0.138 | 0.091 |
| Sol01                                          |   | 0.117 | 0.364 | 0.010 |
| Sol02                                          |   | 0.064 | 0.324 | 0.036 |
| Sol03                                          |   | 0.164 | 0.252 | 0.092 |
| Three items from *satisfaction* combined         |   | 0.124 | 0.221 | 0.083 |
| Three items from *self-stereotyping* combined    |   | 0.106 | 0.238 | 0.026 |
| Three items from *in-group homogeneity* combined |   | 0.040 | 0.124 | 0.095 |
| CN2                                            |   | 0.040 | 0.022 | 0.368 |
| CN3                                            |   | 0.109 | 0.112 | 0.411 |
| CN5                                            |   | 0.066 | 0.055 | 0.287 |
| CN6                                            |   | 0.000 | 0.070 | 0.216 |
| CN8                                            |   | 0.013 | 0.055 | 0.292 |

Here are the chances of this network structure replicating in other samples.

```{r}
# Compute bootstrap
boot <- bootEGA(new.items, n = 1000, model = "glasso",
                algorithm = "louvain",
                type = "parametric", plot.typicalStructure = FALSE,
                ncores = 7)
# Compute structural consistency
sc <- dimStability(boot, orig.wc = ega$wc)
# Print structural consistency
#sc$dimensions ## 0.986 0.885 1.000
# Item stability statistics plot
sc$items$plot.itemStability
# View item stability across dimensions
#View(sc$items$item.dim.rep)
```

Finally, let's look at the centrality plot once again. After EGAnet’s item-reduction process, we got CN3, sol01, cen02 at the top. Well, I guess this means EGAnet’s procedure does not perform any better or worse than networktools’ procedure when it comes to making centrality plots more reliably interpretable.

##### centrality plot of the network after item reduction with ```EGAnet```

```{r}
lbs_up_EGA <- scan("DE.RData_00_labels_up_EGA.txt",what = "character", sep = "\n")
nw_red_EGA <- estimateNetwork(new.items, default = "EBICglasso", tuning = 0.5, missing = "pairwise", threshold = T, lambda.min.ratio=0.001)
```

```{r fig.keep='none'}
nw_red_EGA_cp <- centralityPlot(nw_red_EGA, scale = "z-scores", include = c("ExpectedInfluence"),
                                orderBy = "ExpectedInfluence", labels = lbs_up_EGA)
nw_red_EGA_cp_op <- expectedInf(nw_red_EGA$graph)
nw_red_EGA_cp_ei <- plot(nw_red_EGA_cp_op, order="value", zscore=T)
```

```{r fig.keep='all'}
grid.arrange(nw_red_EGA_cp,nw_red_EGA_cp_ei,
             ncol = 2, nrow=1,
             left = "by qgraph",
             right = "by networktools")
```

```{r}
#DE_miss <- readxl::read_excel("DE_miss.xlsx")
#library(magrittr)
#cols <- c("ImmBG","nationality","AgeG","gender","UniStdYN","BornIn","BornInUrRur","LivesIn","LivesInUrRur")
#DE_miss %<>% mutate_each_(funs(factor(.)),cols)
#DE_miss <- DE_miss %>% select(cols)
#new_items_full <- bind_cols(DE_miss,new.items)
#save(new_items_full, file = "new_items_full.RData")
```

Overall, judging from this little analysis looks like there may not be much correspondence between IRT’s information and attitude networks’ node centrality. Well, I guess the paradigms are quite different, to begin with. Is there a theoretical and/or empirical reason to expect that the item that can provide more information about a latent trait can also be more central in an attitude network? In my crazy world, there is a theoretical reason to expect that, but the empirical stuff beats me. I just keep an eye on the evolving literature.

Before moving on the third/final aim of this blog post (I think I already made this clear from the tone anyway but still…), I think ```EGAnet```’s item reduction procedure is much better compared to ```networktools```’ functions. One downside of ```EGAnet``` is it not liking missing values. I had to remove all the missing values, which reduced my sample size from 2223 to 1567.

## Networktree: to see the influence of socio-demographics + political orientation

Now that we have a reduced network, we can move on to examining the correlates with model-based recursive partitioning (again ***see*** [this](https://osf.io/ha4cw/){target="_blank"} and [this](blog_2019_04_16.html)). Easy-peasy! Looks like political orientation is an obvious moderator for national identification in this sample. On the right side of the spectrum, we see the influence of immigrant background and gender. On the left, the age-group and immigrant background play a role. The socio-demographics + the political orientation is never surprising/interesting. What is always more interesting is the psychological profiles.

```{r}
rm(list = ls(all.names = T))
load("new_items_full.RData")
library(networktree)
nodevar_names <- paste(c("Cen01","Cen02","Cen03",
                         "Sol01","Sol02","Sol03",
                         "SatCom","Sscom","IHcom",
                         "CN2","CN3","CN5","CN6","CN8"), collapse = "+")
splitvars_names <- paste(c("ImmBG","nationality","AgeG","gender","UniStdYN",
                           "BornInUrRur","LivesInUrRur","LRpoC","EastWest"), collapse = "+")
nw_f <- as.formula(paste(c(nodevar_names, splitvars_names), collapse= "~"))
ni_nw <- networktree(nw_f,
                     data = new_items_full,
                     method = "ctree",
                     model = "correlation",
                     transform = "glasso")
plot(ni_nw, type = "glasso", layout="circle", maximum=1, edge.labels=T, edge.label.cex=1, theme="colorblind")
```

## Psychological profiles with attitude networks

[Correlational class analysis](https://www.sociologicalscience.com/articles-v4-15-353/){target="_blank"}[^4] suggests two latent profiles using the reduced attitude network. Profile 2’s global strength[^5] is significantly higher than Profile 1’s. The transitivities (read as network densities) are also obviously/visually different. Below are the attitude networks of the two profiles; the third plot shows the significantly different edges between the profiles. Let me put it this way: there are 15 edges with a significant weight difference on a p<.05 level; not all of these 15 are displayed on the plot, and I’m only going to focus on the significantly different edges that have weight differences >.1 (also see the table below).

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
rm(list=setdiff(ls(), "new_items_full"))
library(corclass)
cca_result <- cca(new_items_full[,11:24], filter.significance = T, filter.value = 0.05, zero.action="ownclass", verbose=T)
new_items_full$profile <- cca_result[["membership"]]
new_items_full$profile <- factor(new_items_full$profile, levels = 1:2, labels = c("profile1","profile2"))
#round(prop.table(table(new_items_full$profile)),2) #50 50
prf1NW <- new_items_full %>% filter(profile%in%"profile1")
prf2NW <- new_items_full %>% filter(profile%in%"profile2")
library(NetworkComparisonTest)
set.seed(123)
prof_comp <- NCT(prf1NW[,11:24], prf2NW[,11:24], gamma=.50, it = 1000,
                 binary.data=F, paired=F, AND=T, test.edges = T, edges ="all", progressbar=T)
prof_comp$glstrinv.pval # 0
prof_comp$glstrinv.sep # P1=5.730385 P2=6.279633
prof_comp$nwinv.pval # 0.122;
p1nw_bn <- estimateNetwork(prf1NW[,11:24], default = "EBICglasso", tuning = 0.5, threshold = T)
p1nw_bn_wmat <- getWmat(p1nw_bn)
p2nw_bn <- estimateNetwork(prf2NW[,11:24], default = "EBICglasso", tuning = 0.5, threshold = T)
p2nw_bn_wmat <- getWmat(p2nw_bn)
inputNCTgraph <- p2nw_bn_wmat - p1nw_bn_wmat
inputNCTgraph[upper.tri(inputNCTgraph)][which(prof_comp$einv.pvals$`p-value` >= .05)] <- 0
inputNCTgraph <- Matrix::forceSymmetric(inputNCTgraph)
library(NetworkToolbox)
round(transitivity(p1nw_bn_wmat, weighted = T),2) # 0.05
p2nw_bn_wmat_min_rem <- p2nw_bn_wmat
p2nw_bn_wmat_min_rem[1,4] <- p2nw_bn_wmat_min_rem[1,4]*-1
p2nw_bn_wmat_min_rem[4,1] <- p2nw_bn_wmat_min_rem[4,1]*-1
round(transitivity(p2nw_bn_wmat_min_rem, weighted = T),2) # 0.07
grps <- c("Centrality","Centrality","Centrality","Mixed","Mixed","Mixed","Mixed","Mixed","Mixed","CN","CN","CN","CN","CN")
clr <-c("red","red","red","green","green","green","green","green","green","blue","blue","blue","blue","blue")
lbs_up_EGA <- scan("DE.RData_00_labels_up_EGA.txt",what = "character", sep = "\n")
par(mfrow=c(1,3))
plot(p1nw_bn, layout = "circle", maximum=1, edge.labels=T, edge.label.cex=1, theme="colorblind", labels = lbs_up_EGA,
     title = "Profile 1 
              \nGlobal strength = 5.7
              \nTransitivity = 0.05", groups = grps, color = clr, legend=F)
plot(p2nw_bn, layout = "circle", maximum=1, edge.labels=T, edge.label.cex=1, theme="colorblind",  labels = lbs_up_EGA,
     title = "Profile 2 
              \nGlobal strength = 6.3
              \nTransitivity = 0.07", groups = grps, color = clr, legend=F)
qgraph(inputNCTgraph, layout = "circle", edge.labels = T, esize = 1, theme = "classic",  labels = lbs_up_EGA,
       title = "Significantly different edges between profiles")
dev.off()
# CN2--Cen01          0.1657296   # 0.17
## CN3--Cen03         0.1593107   # 0.16
### CN5--Sol01        0.117136    # 0.12
#### CN08--Sol02      0.1648883   # 0.16
##### Sscom--SatCom   0.1651241   # 0.17
###### CN5--SatCom   -0.1000334   # -0.1
####### CN6--SatCom   0.1350754   # 0.14
```

| Edges         | the difference between edge-strength |
|---------------|-------------------------------------:|
| CN2--Cen01    |                                 0.17 |
| CN3--Cen03    |                                 0.16 |
| CN5--Sol01    |                                 0.12 |
| CN08--Sol02   |                                 0.16 |
| Sscom--SatCom |                                 0.17 |
| CN5--SatCom   |                                 -0.1 |
| CN6--SatCom   |                                 0.14 |

</br>
6/7 significantly different edges (with weights >.1) involves *collective narcissism*, which hints the importance of this construct in national identification. Below are the plots with Eigen model configurations. It’s not super obvious what the X & Y axis represent here, but for Profile 1, Cen03 (<font size="1">Being German is an important part of how I see myself</font>) is high on both axis. All the items except combined *in-group homogeneity* and *self-stereotyping* are aligned to the right on the x-axis for Profile 1. Cen01 (<font size="1">I often think about the fact that I am German</font>) and CN8 (<font size="1">Not many people seem to fully understand the importance of Germany</font>) are closely related somewhere in the middle. In contrast, Profile 2’s attitude network is wide-ranging on the x-axis. More *collective narcissism* items are higher on the y-axis. In Profile 2 network, Cen03 (<font size="1">Being German is an important part of how I see myself</font>) & CN3 (<font size="1">I will never be satisfied until Germany gets all it deserves</font>) are very closely related somewhere towards the high-end of both x & y axes.

```{r echo=FALSE, results='hide', message = FALSE, fig.keep='all'}
par(mfrow=c(1,2))
EIGENnet(p1nw_bn$graph, S = 10000, seed = 123, maximum=1, edge.labels=T, edge.label.cex=1,
         labels = lbs_up_EGA, title = "Profile 1 Eigen Model Configuration",
         theme="colorblind", vTrans = 200, groups = grps, color = clr, legend=F)
EIGENnet(p2nw_bn$graph, S = 10000, seed = 123, maximum=1, edge.labels=T, edge.label.cex=1,
         labels = lbs_up_EGA, title = "Profile 2 Eigen Model Configuration", 
         theme="colorblind", vTrans = 200, groups = grps, color = clr, legend=F)
dev.off()
```

I think the close relationship between Cen01—CN8 in Profile 1’s network reflects a vulnerable *collective narcissism*. German national identity is salient for Profile 1, and the frustration of others not fully recognizing the country’s importance accompanies this saliency. National identity is salient for Profile 2 as well. However, for this profile, there is that exaggerated emotional investment closely accompanying the identity *centrality*, indicated by CN3 (<font size="1">I will never be satisfied until Germany gets all it deserves</font>). My best guess is that Profile 2 is high on both *self-investment* and *self-definition*; Profile 1 is high(ish) on *self-investment* but not so high on *self-definition*. This guess can be (dis-)/confirmed with actual factor scores, which I’m not going to do in this blog post. And, BTW, those who are interested in the different perceptions of German national identity can also take a look at [this](https://jspp.psychopen.eu/article/view/557){target="_blank"}.

That is the end of the three things I wanted to do.

Takeaways are

* Probably we are not near seeing an alignment between IRT’s IIC’s and node centrality measures in attitude networks.
* I prefer ```EGAnet```’s item-reduction approach over ```networktools```’ approach.
* In this convenience sample, I found two distinct psychological profiles utilizing the attitude network paradigm; socio-demographics are boring as hell.

# References

Boutyline, A., & Vaisey, S. (2017). Belief Network Analysis: A Relational Approach to Understanding the Structure of Attitudes. American Journal of Sociology, 122(5), 1371-1447. doi:10.1086/691274

Bringmann, L. F., Elmer, T., Epskamp, S., Krause, R. W., Schoch, D., Wichers, M., . . . Snippe, E. (2019). What do centrality measures measure in psychological networks? Journal of Abnormal Psychology, 128(8), 892-903. doi:10.1037/abn0000446

Christensen, A. P., Golino, H., & Silvia, P. (2019, March 4). A Psychometric Network Perspective on the Validity and Validation of Personality Trait Questionnaires. https://doi.org/10.31234/osf.io/ktejp

Ditlmann, R. K., & Kopf-Beck, J. (2019). The Meaning of Being German: An Inductive Approach to National Identity. Journal of Social and Political Psychology, 7(1), 423-447. doi:10.5964/jspp.v7i1.557

Golec de Zavala, A., Dyduch-Hazar, K., & Lantos, D. (2019). Collective Narcissism: Political Consequences of Investing Self-Worth in the Ingroup’s Image. Political Psychology, 40(S1), 37-74. doi:10.1111/pops.12569

Jones, P. J., Mair, P., & McNally, R. J. (2018). Visualizing Psychological Networks: A Tutorial in R. Frontiers in Psychology, 9(1742). doi:10.3389/fpsyg.2018.01742

Jones, P. J., Mair, P., Simon, T., & Zeileis, A. (2019). Network Model Trees. https://doi.org/10.31219/osf.io/ha4cw

Robinaugh, D. J., Millner, A. J., & McNally, R. J. (2016). Identifying highly influential nodes in the complicated grief network. Journal of abnormal psychology, 125, 747.

Roth, J., & Mazziotta, A. (2015). Adaptation and validation of a German Multidimensional and Multicomponent Measure of Social Identification. Social Psychology, 46(5), 277–290. https://doi.org/10.1027/1864-9335/a000243

van Bork, R., Rhemtulla, M., Waldorp, L. J., Kruis, J., Rezvanifar, S., & Borsboom, D. (2019). Latent Variable Models and Networks: Statistical Equivalence and Testability. Multivariate Behavioral Research, 1-24. doi:10.1080/00273171.2019.1672515

[^1]: <font size="1">An ad-hoc solution to the apparent problem had been the “expected influence” measure, which can account for the edges with negative weights (***see*** [this](https://doi.org/10.1037/abn0000181){target="_blank"}). Though, the overall interpretation limitation and the unreliability of these centrality measures remain as issues.</font>
[^2]: <font size="1">This is "an exaggerated emotional investment in the nation by believing that other groups insufficiently appreciate the nation's exceptionality".</font>
[^3]: <font size="1">I can sense those who are familiar to the IICs raising their eyebrows after seeing the jiggly curves. I take full responsiblity for that :) This is a pooled sample, and in one of the sub-samples the response categories for national identification scale were different: 1-7 in contrast to 1-5. You don't even wanna see the CCC's. Though, take my word for it, don't judge by the plots ;) this national identification scale has solid psychometric properties; try it with proper samples. I don't think I'm messing up too much with the (accumulated) information here.</font>
[^4]: <font size="1">Read this as “analysis based solely on association patterns without much of a penalization”.</font>
[^5]: <font size="1">Nothing but the absolute sum of all edges in the network. The formal comparison relies on a permutation test to examine the invariance in the global strengths.</font>